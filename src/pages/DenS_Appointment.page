<apex:page standardController="DenS_Appointment__c"
    extensions="DenS_AppointmentController" standardStylesheets="true"
    showHeader="true" sidebar="true" recordSetVar="allappoints" id="apage">
    <!-- TODO
      -->
    <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" />
    <head>
<style>
/*general*/
body {
    text-align: center;
    margin: auto;
}
.head {
    text-align: right;
}

h1, h2, h3, h4, h5, h6 {
    font-size: 46px;
    font-family: Futura, Cambria, Pier, Constantia;
    color: black;
}

h2 {
    font-size: 34px;
}

h3 {
    font-size: 22px;
}

h4 {
    font-size: 19px;
}

h5 {
    font-size: 16px;
    font-weight: 500;
    display: block;
    font-family: Arial, Futura, Cambria, Pier, Constantia;
}

.inputOrSelList {
    font-size: 18px;
}

.detailList {
    text-align: center;
    margin: auto;
    font-size: 20px;
    border-spacing: 4px; //
    margin-right: 670px;
}

.width100 {
    width: 100%;
}
.importantClick2 {
    color: rgb(0,0,140);
    cursor: pointer;
}

/*form-control*/
.form-control {
    display: block;
    width: 96%;
    height: 22px;
    padding: 10px 10px;
    font-size: 14px;
    line-height: 1.42857143;
    color: #555;
}
/*calendar*/
#divcalendar {
    width: 400px;
}

.divCal {
    display: inline-block;
    text-decoration: none;
    height: 30px;
    width: 40px;
    text-align: center;
    cursor: default;
    font-weight: 800;
}

.daysCal {
    background: #eee;
    border: 3px solid black;
}

ul {
    list-style-type: none;
}

.month {
    padding: 5px 0px;
    background: #1abc9c;
}

.month ul {
    margin: 0;
    padding: 0;
}

.month ul li {
    color: white;
    font-size: 24px;
    text-transform: uppercase;
    letter-spacing: 3px;
    text-align: center;
}

.month .prev {
    float: left;
    padding-top: 10px;
    margin-left: 3px;
    cursor: pointer;
}

.month .next {
    float: right;
    padding-top: 10px;
    cursor: pointer;
}

.weekdays {
    margin: 0;
    padding: 10px 10px 10px 0px;
    background-color: #ddd;
}

.weekdays li {
    display: inline-block;
    width: 6.6%;
    color: #666;
    text-align: center;
    font-size: 16px;
}

.days li {
    margin-bottom: 5px;
    font-size: 16px;
    color: #777;
}

.today {
    border-bottom: solid red;
}

.greenBack {
    background-color: rgb(0, 250, 0) !important;
    cursor: pointer;
}

.redBack {
    background-color: rgb(220, 0, 0);
    opacity: 0.6;
}

body a:hover {
    text-decoration: none;
    color: black;
}
/*message*/
.messageTable {
    font-size: 16px;
    margin: auto !important;
}

.message {
    margin: auto;
    width: 700px;
    background-color: #8fffe9 !important;
}

.msgIcon {
    display: none;
}

/*page block + its tables*/
.pbHeader td.pbTitle ~ td {
    display: none;
}

body .bPageBlock .pbTitle h2 {
    font-size: 19px;
    text-align: -webkit-center;
}

body .secondaryPalette.bPageBlock {
    border: none;
}

body .bPageBlock .pbBody .labelCol, body .detailList .labelCol {
    vertical-align: middle;
    font-size: 16px;
    width: 14%;
    color: black;
    font-weight: 500;
}
.labelCol {
    font-size: 16px;
    color: black;
    font-weight: 500;
}
.inline {
    display: inline;
}
.specmargins {
    margin-left: 20px;
    padding-right: 25px;
    font-size: 16px;
}

.mainDiv {
    width: 800px !important;
}

form {
    text-align: -webkit-center;
}

.aDatePick .bPageBlock .pbBody .labelCol {
    vertical-align: top;
}

.aDatePick .bPageBlock .pbBody .dataCol {
    padding: 2px 6px;
}

.marg115 {
    margin-left: 115px;
}
.marg80 {
    margin-left: 80px;
}
.marg30 {
    margin-left: 30px;
}

.margR0 {
    text-align: right !important;
}

.tarea {
    height: 160px;
    width: 635px
}

/*tables*/
.table {
    border-spacing: 0px;
}
.outer td {
    vertical-align: middle;
    text-align: center;
}
table.listTable, th, td {
    border-collapse: collapse;
}
.listTable {
    font-size : 16px;
    font-weigth: bold; 
    overflow-y: auto;
    overflow: hidden;
}
.listTable td.leftAlign {
    padding: 0px 0px 0px 18px;
    text-align: left;
}
table.listTable th {
    padding: 0px 5px;
    border: 1px solid #1abc9c;
    border-bottom: 1px solid black;
    text-align: center;
    height: 30px;
    background: #1abc9c;
    color: white;
}
table tbody {
    border: 1px solid black;
}
.listTable tr:nth-child(odd) td {   
     background: #aeffd9;
}
.listTable tr:nth-child(even) td {  
     background: #8fffe9;
} 
</style>
    </head>
    <script>
      j$ = jQuery.noConflict();
      j$(document).ready(function() {
        /*j$('[class*=configDetails').hide();    SHOULDBE*/
        if ( "{!userProfile}" == 'Dentist') {
            j$('[id*=pageA').hide();
        }
        else if ( "{!userProfile}" == 'Client' ) { 
            j$('[id*=pageC').hide();
        }
         j$('[id*=pageAL').show();
      });
      j$('[id*=appointmentDetails').ready( function(){
          j$('[id*=appointmentDetails').hide();
          if ( {!showAppDetails} ) {
              j$('[id*=appointmentDetails').show();
              j$('[id*=descr').hide();
          }
          /*
          function func()
          {
           alert("hi");
          }
            setTimeout(func, 1000);
          */
      });
      function toggleDescription() {
            j$('[id*=descr').toggle();
      }
      function clickableMouseenter () {
        j$('[class*=i').css({"color": "rgb(0,0,190)"});
      }
      function clickableMouseleave () {
        j$('[class*=clickable').css({"color": "rgb(0,0,100)"});
      }
      j$('[id*=daysCal').ready( function(){
            arr = "{!calendarDetails.styles}";
            arr = arr.slice(1,arr.length-1);
            arr = arr.split(',');
            idStart = "apage\\:forma\\:aDatePickPageBlock\\:aDatePickPageBlockSection\\:daysBlock\\:day\\:";
            idEnd = "\\:dayl";
            for (i = 0; i < arr.length; i++) {
                temp = '[id*=' + idStart + i + idEnd;
                if (arr[i]==0) {
                    j$(temp).addClass("divCal");
                }
                else if (arr[i]==1) {
                    j$(temp).addClass("divCal greenBack");
                }
                else if (arr[i]==2) {
                    j$(temp).addClass("divCal redBack");
                }
            }
      });
      j$('[id*=pageC').ready( function(){
            clickWeekdayC();
      });
      function clickWeekdayC() {
        callChangeConfigTypeW();
        j$('[id*=selectweekday').show();
        j$('[id*=selectdate').hide();
        j$('[class*=dateFormat').hide();
        j$('[id*=chooseWConfig').css({"border-style": "solid", "border-color": "rgb(0,0,255)/*rgb(0,185,0)*/", "border-width": "0px 0px 3px 0px", "border-radius": "5px"});
        j$('[id*=chooseSConfig').css({"border-style": "none"});
      }
      function clickSpecificC() {
        callChangeConfigTypeS();
        j$('[id*=selectweekday').hide();
        j$('[id*=selectdate').show();
        j$('[class*=dateFormat').show();
        j$('[id*=chooseSConfig').css({"border": "3px solid rgb(0,0,255) /*rgb(255,255,155)*/", "border-width": "0px 0px 3px 0px", "border-radius": "5px"});
        j$('[id*=chooseWConfig').css({"border-style": "none"});
      }
      
      /*
      function clicksetconfig () {
        j$('[class*=configDetails').show();
        j$('[class*=configDetails2').hide();
        j$('[id*=setConfig').hide();
      }
      function hideconfigDetails() {
          //j$('[class*=configDetails').hide();
          //j$('[id*=setConfig').show();
      }
      function setConfigWTypeMouseenter () {
        //j$('[id*=chooseWConfig').css({"color": "rgb(90,0,0)"});
      }
      function setConfigWTypeMouseleave () {
        //j$('[id*=chooseWConfig').css({"color": "rgb(0,85,0)"});
      }
         function setConfigSTypeMouseenter () {
        //j$('[id*=chooseSConfig').css({"color": "rgb(90,0,0)"});
      }
      function setConfigSTypeMouseleave () {
        //j$('[id*=chooseSConfig').css({"color": "rgb(0,85,0)"});
      }
      function clickableMouseenter (this) {
        j$(this).css({"color": "rgb(0,0,250)"});
      }
      function clickableMouseleave () {
        j$(this).css({"color": "rgb(0,0,140)"});
      }
      */
   </script>
    <apex:form id="forma">
        <br />
        <br />
        <br />
        <div id="pageA" class="mainDiv">
            <div id="aDatePick" class="aDatePick">
                <h5 class="head">Appointment form</h5>
                <br /> <br /> <br />
                <h4>Choose your dentist and click on your appointment date</h4>
                <br /> <br />
                <apex:pageBlock id="aDatePickPageBlock">
                    <apex:pageBlockSection id="aDatePickPageBlockSection" columns="2">
                        <apex:selectList label="Dentist" id="selectDentist"
                            styleClass="inputOrSelList width100" value="{!dentistId}"
                            size="1" multiselect="false"
                            onchange="callSetDisplayMonthAndYear (); ">
                            <apex:selectOptions value="{!dentists}" />
                        </apex:selectList>
                        <apex:outputPanel id="calendar">
                            <div id="divcalendar">
                                <div class="month">
                                    <ul>
                                        <li class="prev" onclick="callSubtractMonth();">&#10094;</li>
                                        <li class="next" onclick="callAddMonth();">&#10095;</li>
                                        <li>{!calendarDetails.monthDisplay}<br /> <span
                                            style="font-size: 18px">{!calendarDetails.yearDisplay}</span>
                                        </li>
                                    </ul>
                                </div>
                                <ul class="weekdays">
                                    <!-- 
                                  <apex:repeat id="day" value="{!daysOfTheWeek}"  var="day">
                                    <li>{!day}</li>
                                  </apex:repeat>
                                   -->
                                    <li>Mo</li>
                                    <li>Tu</li>
                                    <li>We</li>
                                    <li>Th</li>
                                    <li>Fr</li>
                                    <li>Sa</li>
                                    <li>Su</li>
                                </ul>
                                <div id="daysCal" class='daysCal'>
                                    <apex:pageBlockSection id="daysBlock" columns="7">
                                        <apex:repeat id="day" value="{!calendarDetails.calendarDays}"
                                            var="day">
                                            <!-- previously it's been styleClass="{!day.styleClass}" -->
                                            <apex:commandLink id="dayl" action="{!dayChosen}"
                                                value="{!day.dayToDisplay}"
                                                onmouseover="commLinkMouseOver (); ">
                                                <apex:param value="{!day.showAppDetailsAndDayToDisplay}"
                                                    name="chosenCalendarDay" assignto="{!chosenDayDummy}">
                                                </apex:param>
                                            </apex:commandLink>
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                </div>
                            </div>
                        </apex:outputPanel>
                    </apex:pageBlockSection>
                </apex:pageBlock>
            </div>
            <br />
            <br />
            <div id="appointmentDetails" class="appointmentDetails">
                <apex:pageBlock title="Appointment Details">
                    <apex:pageBlockSection columns="2">
                        <apex:outputField styleClass="form-control"
                            value="{!appointment.Date__c}">
                        </apex:outputField>
                        <apex:selectList styleClass="inputOrSelList width100"
                            value="{!pomS}" size="1" Label="Selected term">
                            <apex:selectOptions value="{!possibleTerms}" />
                        </apex:selectList>
                    </apex:pageBlockSection>
                    <apex:pageBlockSection columns="1">
                        <apex:inputText styleClass="form-control"
                            value="{!client.FirstName}" />
                        <apex:inputText styleClass="form-control"
                            value="{!client.LastName}" />
                        <apex:inputField styleClass="form-control" value="{!client.Email}" />
                        <apex:inputField styleClass="form-control" value="{!client.Phone}" />
                        <apex:selectList styleClass="inputOrSelList marg115"
                            value="{!appointmentType}" size="1" multiselect="false"
                            onchange="toggleDescription();">
                            <apex:selectOptions value="{!appointmentTypes}" />
                        </apex:selectList>
                    </apex:pageBlockSection>
                </apex:pageBlock>
                <div class="detailList">
                    <div id="descr" class="vertMid">
                        <div class="specmargins inline">Description</div>
                        <apex:inputTextarea styleClass="margR0 tarea"
                            value="{!description}" />
                    </div>
                    <p />
                    <apex:commandLink styleClass="saveB, margR0" action="{!save}"
                        style="text-decoration: none;" reRender="tPanel">
                        <apex:commandButton styleClass="saveB" action="{!save}"
                            value="Set appointment" />
                    </apex:commandLink>
                </div>
            </div>
            <apex:outputPanel id="tPanel">
                <apex:pageMessages />
            </apex:outputPanel>
        </div>
        <apex:actionFunction action="{!setDisplayMonthAndYear}"
            name="callSetDisplayMonthAndYear" />
        <apex:actionFunction action="{!addMonth}" name="callAddMonth" />
        <!--   oncomplete="hideAppointmentDetails (); rerenderCalendar();"   -->
        <apex:actionFunction action="{!subtractMonth}"
            name="callSubtractMonth" />
        <apex:actionFunction action="{!doNothing}" name="rerenderCalendar"
            rerender="calendar, tPanel" />



        <div id="pageC" class="mainDiv">
            <br /> <br /> <br />
            <h5 class="head">Working hours of {!$User.FirstName}
                {!$User.LastName}</h5>
            <br /> <br />
            <div class="configDetails">
                <div class="labelCol inline">
                    <h4>Set a config</h4>
                    <br />
                    <br />
                    <div>Config type: &nbsp; &nbsp; &nbsp;
                        <h5 id="chooseWConfig" class="importantClick2 inline"
                            onclick="clickWeekdayC();">Weekday</h5>
                        <h5 id="chooseSConfig" class="importantClick2 inline marg30"
                            onclick="clickSpecificC();">Specific day</h5>
                    </div>
                    <br />
                    <br />
                </div>
                <div class="configDetails2 inline" rendered="false">
                    <apex:selectList id="selectweekday"
                        styleClass="inputOrSelList" value="{!pomW}" size="1"
                        multiselect="false">
                        <apex:selectOptions value="{!weekdaysConfig}" />
                    </apex:selectList>
                    <apex:inputField id="selectdate" styleClass="inputOrSelList"
                        value="{!config.date__c}" showDatePicker="true">
                    </apex:inputField>
                    <h5 class="labelCol inline marg30">Start time</h5>
                    <apex:selectList styleClass="inputOrSelList inline " value="{!pomSConfig}" size="1"
                        label="Start time">
                        <apex:selectOptions value="{!WorkingHours}" />
                    </apex:selectList>
                    <h5 class="labelCol inline marg30">End time</h5> 
                    <apex:selectList styleClass="inputOrSelList inline" value="{!pomEConfig}" size="1"
                        Label="End time">
                        <apex:selectOptions value="{!WorkingHours}" />
                    </apex:selectList>
                    <br />
                    <br />
                    <apex:commandLink styleClass="saveB" action="{!saveConfig}"
                        style="text-decoration: none;" reRender="thePanel,configsTable">
                        <apex:commandButton styleClass="saveB" value="Set config" />
                    </apex:commandLink>
                    <p />
                    <br />
                </div>
                <apex:outputPanel id="thePanel" styleClass="messagePanel, middle">
                    <apex:pageMessages />
                </apex:outputPanel>
            </div>
            <br />
            <apex:outputPanel id="configsTable">
                <h4>Configs</h4>
                <p/>
                <apex:dataTable styleClass="listTable inline" id="tabW" VALUE="{!wconfigs}"
                    var="con" rowClasses="odd,even" cellspacing="10">
                    <apex:column styleClass="leftAlign" headerValue="Weekday">
                        <apex:outputField value="{!con.Weekday__c}">
                        </apex:outputField>
                    </apex:column>
                    <apex:column headerValue="Start time">
                        <c:out TimeInMinutes="{!con.Start_time__c}" />
                    </apex:column>
                    <apex:column headerValue="End time">
                        <c:out TimeInMinutes="{!con.End_time__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:commandLink action="{!removeConfig}"
                            reRender="configsTable" style="text-decoration: none;">
                            <apex:commandButton value="Delete" /> 
                            <apex:param value="{!con.Id}" name="configsToDeleteID"
                                assignTo="{!configsToDeleteID}" />
                        </apex:commandLink>
                    </apex:column>
                </apex:dataTable>
                <apex:dataTable styleClass="listTable inline marg80" id="tabS" VALUE="{!sconfigs}"
                    var="con" rowClasses="odd,even" cellspacing="10">
                    <apex:column styleClass="leftAlign" headerValue="Specific day">
                        <apex:outputField value="{!con.date__c}">
                        </apex:outputField>
                    </apex:column>
                    <apex:column headerValue="Start time ">
                        <c:out TimeInMinutes="{!con.Start_time__c}" />
                    </apex:column>
                    <apex:column headerValue="End time ">
                        <c:out TimeInMinutes="{!con.End_time__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:commandLink action="{!removeConfig}"
                            reRender="configsTable" style="text-decoration: none;">
                            <apex:commandButton value="Delete" />
                            <apex:param value="{!con.Id}" name="configsToDeleteID"
                                assignTo="{!configsToDeleteID}" />
                        </apex:commandLink>
                    </apex:column>
                </apex:dataTable>
            </apex:outputPanel>
            <apex:actionFunction action="{!changeConfigTypeW}"
                name="callChangeConfigTypeW" rerender="thePanel" />
            <apex:actionFunction action="{!changeConfigTypeS}"
                name="callChangeConfigTypeS" rerender="thePanel" />               
        </div>
        
        
        
        
        <div Id="pageAL" class="mainDiv">
            <br/>
            <br/>
            <br/> 
               <h4>Show appointments by:</h4>
               <p/>
            <apex:selectCheckboxes value="{!searchCriteria}">
               <apex:selectOptions value="{!searchCrits}"/>
            </apex:selectCheckboxes><br/>
            <apex:pageBlock >            
                <apex:pageBlockSection id="calendar" columns="2">
                     <apex:outputPanel id="calendar">
                        <div id="divcalendar">
                            <div class="month"> 
                              <ul>
                                <li class="prev" onclick="callSubtractMonth();">&#10094;</li>
                                <li class="next" onclick="callAddMonth();">&#10095;</li>
                                <li>
                                  {!calendarDetails.monthDisplay}<br/>
                                  <span style="font-size:18px">{!calendarDetails.yearDisplay}</span>
                                </li>
                              </ul>
                            </div>
                            <ul class="weekdays">
                            <apex:repeat id="day" value="{!daysOfTheWeek}"  var="day">
                                    <li>{!day}</li>
                            </apex:repeat>
                   </ul>
                            <div id="daysCal" class='daysCal'>
                                <apex:pageBlockSection id="daysBlock" columns="7" >
                                        <apex:repeat id="day" value="{!calendarDetails.calendarDays}"  var="day">
                                            <apex:commandLink id="dayl" action="{!dayChosen}" styleClass="{!day.styleClass}"
                                                               value="{!day.dayToDisplay}" rerender="tPanel, appointmentDetails">
                                            <apex:param value="{!day.dayToDisplay}" name="chosenCalendarDay" assignto="{!chosenDayDummy}"> </apex:param>
                                            </apex:commandLink>
                                        </apex:repeat>
                                </apex:pageBlockSection>
                            </div>
                        </div>
                     </apex:outputPanel> 
                 </apex:pageBlockSection>
               </apex:pageBlock>      
               <apex:selectList styleClass="inputOrSelList" value="{!pickListsAL}[0]" size="1" Label="Status" onchange="">
                       <apex:selectOptions value="{!Statuses}"/>
                  </apex:selectList> 
                  <apex:selectList styleClass="inputOrSelList" value="{!pickListsAL}[1]" size="1" Label="Client" onchange="">
                       <apex:selectOptions value="{!clients}"/>
                  </apex:selectList> 
                  <apex:selectList styleClass="inputOrSelList" value="{!pickListsAL}[2]" size="1" Label="Appointment type" onchange="">
                       <apex:selectOptions value="{!appointmentTypes}"/>
                </apex:selectList> 
            <apex:outputPanel id="appointsTable">
                <table class="table3" >
                        <!-- tu info o appointmentsach --> 
                   <apex:dataTable styleClass="Wizardtable table2" id="tabA" VALUE="{!wconfigs}" var="con" rowClasses="odd,even" cellspacing="10">
                        <apex:column >
                        
                        </apex:column>
                        <apex:column >
                        
                        </apex:column>
                        <apex:column >
                         
                        </apex:column>
                        <apex:column >
                        
                        </apex:column>
                        <apex:column >
                        
                        </apex:column>
                            <apex:column >
                        
                        </apex:column>
                        <apex:column >
                        
                        </apex:column>
                   </apex:dataTable>
                </table>
            </apex:outputPanel> 
        </div>
    </apex:form>
</apex:page>